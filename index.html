<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Katalog Perkakas Pro - Detail</title>
    <style>
        :root { --primary: #e67e22; --dark: #2c3e50; --light: #f4f7f6; --success: #25d366; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); margin: 0; padding-bottom: 120px; }
        
        header { background: var(--dark); color: white; text-align: center; padding: 20px; }
        .filter-container { text-align: center; padding: 15px; background: white; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .filter-btn { border: 2px solid var(--primary); background: none; color: var(--primary); padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; margin: 3px; }
        .filter-btn.active { background: var(--primary); color: white; }

        .container { max-width: 1000px; margin: auto; padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; cursor: pointer; }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .card-body { padding: 15px; }
        .price { color: var(--primary); font-weight: bold; font-size: 1.2em; }
        
        /* Modal Detail */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); overflow-y: auto; }
        .modal-content { background: white; margin: 5% auto; padding: 20px; border-radius: 15px; width: 90%; max-width: 500px; position: relative; }
        .close-modal { position: absolute; top: 10px; right: 20px; font-size: 30px; cursor: pointer; color: #333; }
        .modal-img { width: 100%; border-radius: 10px; margin-bottom: 15px; }

        .cart-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; z-index: 1000; }
        .btn-checkout { background: var(--success); color: white; text-decoration: none; padding: 12px 20px; border-radius: 25px; font-weight: bold; }
        .btn-add { width: 100%; background: var(--primary); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

<header>
    <h1>üõ†Ô∏è Toko Perkakas & Golok Amboy</h1>
</header>

<div class="filter-container">
    <button class="filter-btn active" onclick="filterBarang('semua', this)">Semua</button>
    <button class="filter-btn" onclick="filterBarang('mesin', this)">Mesin</button>
    <button class="filter-btn" onclick="filterBarang('manual', this)">Manual</button>
</div>

<div class="container" id="produk-list">
    <p id="loading">Memuat produk...</p>
</div>

<div id="modalDetail" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="tutupDetail()">&times;</span>
        <img id="detailImg" class="modal-img" src="" alt="">
        <h2 id="detailNama"></h2>
        <p id="detailHarga" class="price"></p>
        <hr>
        <h4>Rincian Produk:</h4>
        <p id="detailDeskripsi"></p>
        <button id="btnTambahDetail" class="btn-add">Tambah ke Keranjang</button>
    </div>
</div>

<div class="cart-bar">
    <div style="display:flex; flex-direction:column;">
        <input type="text" id="nama-pembeli" placeholder="Nama Anda..." style="padding:8px; margin-bottom:5px;">
        <strong>Total: <span id="cart-total">Rp 0</span></strong>
    </div>
    <a href="#" class="btn-checkout" onclick="kirimWA()">Pesan WA</a>
</div>

<script>
    const linkGSheet = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRtNoerhDtHch7TNHVbItg23RG4nneoZ8hv5MBR1Cr40iU5alO8a2O4EUR90YgleMH4-E-6zGJsEgcN/pub?output=csv";
    const nomorWA = "628123456789";
    let keranjang = [];
    let totalHarga = 0;

    async function loadProduk() {
        try {
            const response = await fetch(linkGSheet);
            const data = await response.text();
            const rows = data.split("\n").slice(1);
            const container = document.getElementById('produk-list');
            container.innerHTML = "";

            rows.forEach(row => {
                const col = row.split(",");
                if(col.length >= 5) {
                    const [nama, harga, kategori, foto, deskripsi] = col;
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.dataset.category = kategori.trim().toLowerCase();
                    card.innerHTML = `
                        <img src="${foto.trim()}" onclick="bukaDetail('${nama}', '${harga}', '${foto.trim()}', '${deskripsi.trim()}')">
                        <div class="card-body">
                            <h3 onclick="bukaDetail('${nama}', '${harga}', '${foto.trim()}', '${deskripsi.trim()}')">${nama}</h3>
                            <p class="price">Rp ${parseInt(harga).toLocaleString('id-ID')}</p>
                            <button class="btn-add" onclick="tambahKeKeranjang('${nama}', ${harga})">+ Keranjang</button>
                        </div>`;
                    container.appendChild(card);
                }
            });
        } catch (e) { document.getElementById('loading').innerText = "Gagal load data."; }
    }

    function bukaDetail(nama, harga, foto, desc) {
        document.getElementById('detailImg').src = foto;
        document.getElementById('detailNama').innerText = nama;
        document.getElementById('detailHarga').innerText = "Rp " + parseInt(harga).toLocaleString('id-ID');
        document.getElementById('detailDeskripsi').innerText = desc;
        document.getElementById('btnTambahDetail').onclick = function() {
            tambahKeKeranjang(nama, parseInt(harga));
            tutupDetail();
        };
        document.getElementById('modalDetail').style.display = "block";
    }

    function tutupDetail() { document.getElementById('modalDetail').style.display = "none"; }

    function tambahKeKeranjang(nama, harga) {
        keranjang.push({nama, harga});
        totalHarga += harga;
        document.getElementById('cart-total').innerText = "Rp " + totalHarga.toLocaleString('id-ID');
        alert(nama + " ditambahkan!");
    }

    function filterBarang(kat, btn) {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.card').forEach(c => {
            c.style.display = (kat === 'semua' || c.dataset.category === kat) ? "block" : "none";
        });
    }

    function kirimWA() {
        let nama = document.getElementById('nama-pembeli').value;
        if (!nama || keranjang.length === 0) return alert("Isi nama & pilih barang!");
        let pesan = `Halo, saya *${nama}* mau pesan:\n` + keranjang.map(i => "- " + i.nama).join("\n") + `\n\n*Total: Rp ${totalHarga.toLocaleString('id-ID')}*`;
        window.open(`https://wa.me/${nomorWA}?text=${encodeURIComponent(pesan)}`, '_blank');
    }

    loadProduk();
</script>
</body>
</html>



